{
    "metadata": {
        "title": "DRB",
        "description": "Simple DRB representation",
        "minimum_version": "0.4"
    },
    "timestepper": {
        "start": "1990-10-01",
        "end": "2021-09-30",
        "timestep": 1
    },
    "scenarios": [
        {
            "name": "inflow",
            "size": 5
        }
    ],
    "nodes": [
        {
            "name": "catchment_can",
            "type": "catchment",
            "flow": "flow_can"
        },
        {
            "name": "catchment_pep",
            "type": "catchment",
            "flow": "flow_pep"
        },
        {
            "name": "catchment_nev",
            "type": "catchment",
            "flow": "flow_nev"
        },
        {
            "name": "catchment_lac",
            "type": "catchment",
            "flow": "flow_lac"
        },
        {
            "name": "reservoir_can",
            "type": "storage",
            "max_volume": 96000,
            "initial_volume": 86400,
            "cost": "storage_cost_can"
        },
        {
            "name": "reservoir_pep",
            "type": "storage",
            "max_volume": 140000,
            "initial_volume": 126000,
            "cost": "storage_cost_pep"
        },
        {
            "name": "reservoir_nev",
            "type": "storage",
            "max_volume": 35000,
            "initial_volume": 31500,
            "cost": "storage_cost_nev"
        },
        {
            "name": "reservoir_agg_NYC",
            "type": "aggregatedstorage",
            "storage_nodes": ["reservoir_can", "reservoir_pep", "reservoir_nev"]
        },
        {
            "name": "link_can_nyc",
            "type": "link"
        },
        {
            "name": "link_pep_nyc",
            "type": "link"
        },
        {
            "name": "link_nev_nyc",
            "type": "link"
        },
        {
            "name": "demand_nyc",
            "type": "output",
            "max_flow": "demand_max_flow_nyc",
            "cost": -500
        },
        {
            "name": "flowtarget_can",
            "type": "rivergauge",
            "mrf": "mrf_target_can",
            "mrf_cost": -1000
        },
        {
            "name": "flowtarget_pep",
            "type": "rivergauge",
            "mrf": "mrf_target_pep",
            "mrf_cost": -1000
        },
        {
            "name": "flowtarget_nev",
            "type": "rivergauge",
            "mrf": "mrf_target_nev",
            "mrf_cost": -1000
        },
        {
            "name": "flowtarget_montague",
            "type": "rivergauge",
            "mrf": "mrf_target_montague",
            "mrf_cost": -1000
        },
        {
            "name": "term1",
            "type": "output"
        }
    ],
    "edges": [
        ["catchment_can", "reservoir_can"],
        ["catchment_pep", "reservoir_pep"],
        ["catchment_nev", "reservoir_nev"],
        ["reservoir_can", "link_can_nyc"],
        ["reservoir_pep", "link_pep_nyc"],
        ["reservoir_nev", "link_nev_nyc"],
        ["link_can_nyc", "demand_nyc"],
        ["link_pep_nyc", "demand_nyc"],
        ["link_nev_nyc", "demand_nyc"],
        ["reservoir_can", "flowtarget_can"],
        ["reservoir_pep", "flowtarget_pep"],
        ["reservoir_nev", "flowtarget_nev"],
        ["flowtarget_can", "flowtarget_montague"],
        ["flowtarget_pep", "flowtarget_montague"],
        ["flowtarget_nev", "flowtarget_montague"],
        ["catchment_lac", "flowtarget_montague"],
        ["flowtarget_montague", "term1"]
    ],
    "parameters": {
        "flow_factor": {
            "name": "flow_factor",
            "type": "constantscenario",
            "scenario": "inflow",
            "values": [0.75, 0.9, 1.0, 1.1, 1.25]
        },
        "flow_cumecs_can": {
              "type": "dataframe",
              "url": "../input_data/inflows_clean.csv",
              "column": "cannonsville",
              "index_col": "datetime",
              "parse_dates": true
        },
        "flow_cumecs_pep": {
              "type": "dataframe",
              "url": "../input_data/inflows_clean.csv",
              "column": "pepacton",
              "index_col": "datetime",
              "parse_dates": true
        },
        "flow_cumecs_nev": {
              "type": "dataframe",
              "url": "../input_data/inflows_clean.csv",
              "column": "neversink",
              "index_col": "datetime",
              "parse_dates": true
        },
        "flow_cumecs_lac": {
              "type": "dataframe",
              "url": "../input_data/inflows_clean.csv",
              "column": "lackawaxen",
              "index_col": "datetime",
              "parse_dates": true
        },
        "flow_can": {
            "type": "aggregated",
            "agg_func": "product",
            "parameters": ["flow_cumecs_can", "flow_factor"]
        },
        "flow_pep": {
            "type": "aggregated",
            "agg_func": "product",
            "parameters": ["flow_cumecs_pep", "flow_factor"]
        },
        "flow_nev": {
            "type": "aggregated",
            "agg_func": "product",
            "parameters": ["flow_cumecs_nev", "flow_factor"]
        },
        "flow_lac": {
            "type": "aggregated",
            "agg_func": "product",
            "parameters": ["flow_cumecs_lac", "flow_factor"]
        },
        "demand_baseline_nyc": {
            "type": "constant",
            "values": 800
        },
        "demand_max_flow_nyc": {
            "type": "aggregated",
            "agg_func": "product",
            "parameters": [
                "demand_baseline_nyc",
                "demand_drought_factor_nyc",
                "demand_growth_factor_nyc"
            ]
        },
        "level1b": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1b",
            "sheet_name": "dailyProfiles"
        },
        "level1c": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1c",
            "sheet_name": "dailyProfiles"
        },
        "level2": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level2",
            "sheet_name": "dailyProfiles"
        },
        "level3": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level3",
            "sheet_name": "dailyProfiles"
        },
        "level4": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level4",
            "sheet_name": "dailyProfiles"
        },
        "level5": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level5",
            "sheet_name": "dailyProfiles"
        },
        "demand_drought_level_nyc" : {
            "type": "controlcurveindex",
            "storage_node": "reservoir_agg_NYC",
            "control_curves": [
                "level1b",
                "level1c",
                "level2",
                "level3",
                "level4",
                "level5"
            ]
        },
        "demand_drought_factor_nyc" : {
            "type": "indexedarray",
            "index_parameter": "demand_drought_level_nyc",
            "params": [
                "level1a_factor_demand_nyc",
                "level1b_factor_demand_nyc",
                "level1c_factor_demand_nyc",
                "level2_factor_demand_nyc",
                "level3_factor_demand_nyc",
                "level4_factor_demand_nyc",
                "level5_factor_demand_nyc"
            ]
        },
        "level1a_factor_demand_nyc": {
            "type": "constant",
            "values": 1.0
        },
        "level1b_factor_demand_nyc": {
            "type": "constant",
            "values": 1.0
        },
        "level1c_factor_demand_nyc": {
            "type": "constant",
            "values": 1.0
        },
        "level2_factor_demand_nyc": {
            "type": "constant",
            "values": 1.0
        },
        "level3_factor_demand_nyc": {
            "type": "constant",
            "values": 0.85
        },
       "level4_factor_demand_nyc": {
            "type": "constant",
            "values": 0.7
        },
        "level5_factor_demand_nyc": {
            "type": "constant",
            "values": 0.65
        },
        "demand_growth_factor_nyc": {
            "type": "constant",
            "value" : 1.0
        },
        "mrf_target_montague": {
            "type": "aggregated",
            "agg_func": "product",
            "parameters": [
                "mrf_baseline_montague",
                "mrf_drought_factor_montague"
            ]
        },
        "mrf_baseline_montague": {
            "type": "constant",
            "url": "profiles.xlsx",
            "index_col": "parameter",
            "index": "mrf_baseline_montague",
            "column": "value",
            "sheet_name": "constants"
        },
        "mrf_drought_factor_montague" : {
            "type": "indexedarray",
            "index_parameter": "demand_drought_level_nyc",
            "params": [
                "level1a_factor_mrf_montague",
                "level1b_factor_mrf_montague",
                "level1c_factor_mrf_montague",
                "level2_factor_mrf_montague",
                "level3_factor_mrf_montague",
                "level4_factor_mrf_montague",
                "level5_factor_mrf_montague"
            ]
        },
        "level1a_factor_mrf_montague": {
            "type": "monthlyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1a_factor_mrf_montague",
            "sheet_name": "monthlyProfiles"
        },
        "level1b_factor_mrf_montague": {
            "type": "monthlyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1b_factor_mrf_montague",
            "sheet_name": "monthlyProfiles"
        },
        "level1c_factor_mrf_montague": {
            "type": "monthlyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1c_factor_mrf_montague",
            "sheet_name": "monthlyProfiles"
        },
        "level2_factor_mrf_montague": {
            "type": "monthlyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level2_factor_mrf_montague",
            "sheet_name": "monthlyProfiles"
        },
        "level3_factor_mrf_montague": {
            "type": "monthlyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level3_factor_mrf_montague",
            "sheet_name": "monthlyProfiles"
        },
        "level4_factor_mrf_montague": {
            "type": "monthlyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level4_factor_mrf_montague",
            "sheet_name": "monthlyProfiles"
        },
        "level5_factor_mrf_montague": {
            "type": "monthlyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level5_factor_mrf_montague",
            "sheet_name": "monthlyProfiles"
        },
        "mrf_target_can": {
            "type": "aggregated",
            "agg_func": "product",
            "parameters": [
                "mrf_baseline_can",
                "mrf_drought_factor_can"
            ]
        },
        "mrf_baseline_can": {
            "type": "constant",
            "url": "profiles.xlsx",
            "index_col": "parameter",
            "index": "mrf_baseline_can",
            "column": "value",
            "sheet_name": "constants"
        },
        "mrf_drought_factor_can" : {
            "type": "indexedarray",
            "index_parameter": "demand_drought_level_nyc",
            "params": [
                "level1a_factor_mrf_can",
                "level1b_factor_mrf_can",
                "level1c_factor_mrf_can",
                "level2_factor_mrf_can",
                "level3_factor_mrf_can",
                "level4_factor_mrf_can",
                "level5_factor_mrf_can"
            ]
        },
        "level1a_factor_mrf_can": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1a_factor_mrf_can",
            "sheet_name": "dailyProfiles"
        },
        "level1b_factor_mrf_can": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1b_factor_mrf_can",
            "sheet_name": "dailyProfiles"
        },
        "level1c_factor_mrf_can": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1c_factor_mrf_can",
            "sheet_name": "dailyProfiles"
        },
        "level2_factor_mrf_can": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level2_factor_mrf_can",
            "sheet_name": "dailyProfiles"
        },
        "level3_factor_mrf_can": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level3_factor_mrf_can",
            "sheet_name": "dailyProfiles"
        },
        "level4_factor_mrf_can": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level4_factor_mrf_can",
            "sheet_name": "dailyProfiles"
        },
        "level5_factor_mrf_can": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level5_factor_mrf_can",
            "sheet_name": "dailyProfiles"
        },
        "mrf_target_pep": {
            "type": "aggregated",
            "agg_func": "product",
            "parameters": [
                "mrf_baseline_pep",
                "mrf_drought_factor_pep"
            ]
        },
        "mrf_baseline_pep": {
            "type": "constant",
            "url": "profiles.xlsx",
            "index_col": "parameter",
            "index": "mrf_baseline_pep",
            "column": "value",
            "sheet_name": "constants"
        },
        "mrf_drought_factor_pep" : {
            "type": "indexedarray",
            "index_parameter": "demand_drought_level_nyc",
            "params": [
                "level1a_factor_mrf_pep",
                "level1b_factor_mrf_pep",
                "level1c_factor_mrf_pep",
                "level2_factor_mrf_pep",
                "level3_factor_mrf_pep",
                "level4_factor_mrf_pep",
                "level5_factor_mrf_pep"
            ]
        },
        "level1a_factor_mrf_pep": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1a_factor_mrf_pep",
            "sheet_name": "dailyProfiles"
        },
        "level1b_factor_mrf_pep": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1b_factor_mrf_pep",
            "sheet_name": "dailyProfiles"
        },
        "level1c_factor_mrf_pep": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1c_factor_mrf_pep",
            "sheet_name": "dailyProfiles"
        },
        "level2_factor_mrf_pep": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level2_factor_mrf_pep",
            "sheet_name": "dailyProfiles"
        },
        "level3_factor_mrf_pep": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level3_factor_mrf_pep",
            "sheet_name": "dailyProfiles"
        },
        "level4_factor_mrf_pep": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level4_factor_mrf_pep",
            "sheet_name": "dailyProfiles"
        },
        "level5_factor_mrf_pep": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level5_factor_mrf_pep",
            "sheet_name": "dailyProfiles"
        },
        "mrf_target_nev": {
            "type": "aggregated",
            "agg_func": "product",
            "parameters": [
                "mrf_baseline_nev",
                "mrf_drought_factor_nev"
            ]
        },
        "mrf_baseline_nev": {
            "type": "constant",
            "url": "profiles.xlsx",
            "index_col": "parameter",
            "index": "mrf_baseline_nev",
            "column": "value",
            "sheet_name": "constants"
        },
        "mrf_drought_factor_nev" : {
            "type": "indexedarray",
            "index_parameter": "demand_drought_level_nyc",
            "params": [
                "level1a_factor_mrf_nev",
                "level1b_factor_mrf_nev",
                "level1c_factor_mrf_nev",
                "level2_factor_mrf_nev",
                "level3_factor_mrf_nev",
                "level4_factor_mrf_nev",
                "level5_factor_mrf_nev"
            ]
        },
        "level1a_factor_mrf_nev": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1a_factor_mrf_nev",
            "sheet_name": "dailyProfiles"
        },
        "level1b_factor_mrf_nev": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1b_factor_mrf_nev",
            "sheet_name": "dailyProfiles"
        },
        "level1c_factor_mrf_nev": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level1c_factor_mrf_nev",
            "sheet_name": "dailyProfiles"
        },
        "level2_factor_mrf_nev": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level2_factor_mrf_nev",
            "sheet_name": "dailyProfiles"
        },
        "level3_factor_mrf_nev": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level3_factor_mrf_nev",
            "sheet_name": "dailyProfiles"
        },
        "level4_factor_mrf_nev": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level4_factor_mrf_nev",
            "sheet_name": "dailyProfiles"
        },
        "level5_factor_mrf_nev": {
            "type": "dailyprofile",
            "url": "profiles.xlsx",
            "index_col": "profile",
            "index": "level5_factor_mrf_nev",
            "sheet_name": "dailyProfiles"
        },
        "storage_cost_can": {
            "type": "interpolatedvolume",
            "node": "reservoir_can",
            "volumes": [0, 96000],
            "values": [-100, -1]
        },
        "storage_cost_pep": {
            "type": "interpolatedvolume",
            "node": "reservoir_pep",
            "volumes": [0, 140000],
            "values": [-100, -1]
        },
        "storage_cost_nev": {
            "type": "interpolatedvolume",
            "node": "reservoir_nev",
            "volumes": [0, 35000],
            "values": [-100, -1]
        }
    }
}
